<html>
	<head>
		<meta http-equiv="X-UA-Compatible" content="IE=100" >
		<title>Princess in a Castle</title>
		<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
		<script type="text/javascript" src="modernizr.js"></script>
		<script type="text/javascript" src="paper.js"></script>

		<script type="text/javascript" src="princess.js"></script>

		<link rel="stylesheet" href="normalize.css"></link>

		<link rel="stylesheet" href="princess.css"></link>

	</head>
	<body>
		<div class="container">
			<div class="interface">
				<div id="savedCastles">
					<h2>Load a Castle</h2>
					<div id="list"></div>
				</div>
				<canvas id="graphCanvas" width="400" height="400"></canvas>
				<div id="buttons">
					<div id="construction">
						<span class="label">Construction:</span>
						<button class="tool" id="addroom">Add a room</button>
						<button class="tool" id="removeroom">Remove a room</button>
						<button class="tool" id="linkrooms">Link rooms</button>
						<button id="clear">Clear castle</button>
						<button id="save">Save castle</button>
					</div>
					<div id="playing">
						<span class="label">Playing:</span>
						<button class="tool" id="look">Look in a room</button>
						<button class="tool" id="toggle">Toggle a room</button>
						<button id="reset">Reset rooms</button>
					</div>
					<div id="strategy">
						<span class="label">Strategy</span>
					</div>
					<div id="controls">
						<span class="label">Animation speed:</span>
						<input type="range" id="animtime" min="1" max="100"/>
					</div>
					<div id="output">
						<button id="snapshot">Save snapshot of current state</button>
						<button id="snapshots">Save snapshots of whole strategy</button>
					</div>
				</div>
			</div>
			<div class="explanation">
				<h1>Princess in a Castle</h1>
				<p>There is a castle with a resident Princess. Each night, the Princess picks a room to sleep in. The room she picks must be directly adjacent to the one she slept in the night before. On the first night, she can pick any room.</p>
				<p>You are not told anything about the Princess’s whereabouts each night, but you may have a look in one room each night. If you pick the room the Princess is in then she will marry you; if not, you can try again the next night.</p>
				<p>The idea of the game is to either find a sequence which is guaranteed to find the Princess, or to prove that no such sequence exists.</p>
				<p></p>
				<p>Use the construction controls to design a castle layout. You can save your castle and it will appear in the list on the right-hand side.</p>
				<p>Once your castle is complete, use the <em>look in a room</em> button to play the game. If it’s possible for the Princess to be in a room at a particular point in time, it will be white. If she can’t be there, it will be grey.</p>
				<p>Each time you look in a room, the next night’s possible Princess moves are shown.</p>
				<p>When all the rooms are grey, that means you have found a sequence of rooms which are guaranteed to find the Princess, no matter what she does.</p>
				<p>To aid with your deliberations, you can use the <em>toggle a room</em> button to put a room in a particular state of occupancy.</p>
				<p>When a move in the <em>Strategy</em> list is displayed in red, that means that the state of the castle is a repeat of one encountered earlier in the strategy, so that move can not be part of the shortest solution. The symmetry of the graph is computed, so if one state looks like a previous one with an automorphism of the graph applied to it, the new move is marked as a repeat.</p>
				<p></p>
				<p>The castles I’ve provided are arranged roughly in order of difficulty.</p>
				<p></p>
				<p>There is some discussion of this puzzle on <a href="http://checkmyworking.com/2011/10/newcastle-mathsjam-october-2011-recap/">my blog</a>.
				<p></p>
				<p>The <em>save snapshot images</em> buttons will attempt to save images of either the current state or of your whole strategy. Because of browser problems, they'll get saved as something like <em>download (N)</em>, but they're all PNG files. Your browser may also complain about being asked to save so many files.</p>
				<p</p>
				<p>To share a castle with somebody else, save it and then copy the URL in your address bar, including the big long hash, and send it to whomsoever you wish.</p>
			</div>
		</div>

		<p class="copyright"><a rel="license" href="http://creativecommons.org/licenses/by/3.0/"><img alt="Creative Commons Licence" style="border-width:0" src="http://i.creativecommons.org/l/by/3.0/80x15.png" /></a><br /><span xmlns:dct="http://purl.org/dc/terms/" href="http://purl.org/dc/dcmitype/InteractiveResource" property="dct:title" rel="dct:type">Princess in a Castle</span> by <a xmlns:cc="http://creativecommons.org/ns#" href="http://checkmyworking.com" property="cc:attributionName" rel="cc:attributionURL">Christian Perfect</a> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/3.0/">Creative Commons Attribution 3.0 Unported License</a>.</p>
	</body>
</html>
